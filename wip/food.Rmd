---
title: "How to build neural nets in R"
author: "Dr. Shirin Glander"
date: '`r Sys.Date()`'
output:
  prettydoc::html_pretty:
    theme: tactile
    highlight: github
---

I've seen many examples for building neural nets with Python. Therefore, I wanted to show here, how it could be done with R.
Obviously, the power of deep learning is in applying it to large datasets with many features (like image categorisation, etc.). Because that's not very handy for demonstration purposes, I am here showing the principles on a small dataset.

The raw data behind the story "The FiveThirtyEight International Food Association's 2014 World Cup" http://fivethirtyeight.com/features/the-fivethirtyeight-international-food-associations-2014-world-cup/. For all the countries below, the response to the following question is presented: "Please rate how much you like the traditional cuisine of X"

5: I love this country's traditional cuisine. I think it's one of the best in the world.

4: I like this country's traditional cuisine. I think it's considerably above average.

3: I'm OK with this county's traditional cuisine. I think it's about average.

2: I dislike this country's traditional cuisine. I think it's considerably below average.

1: I hate this country's traditional cuisine. I think it's one of the worst in the world.

N/A: I'm unfamiliar with this country's traditional cuisine.

```{r}
library(fivethirtyeight)

# backup copy:
food_world_cup_copy <- food_world_cup

head(food_world_cup)
```

```{r}
food_world_cup[food_world_cup == "N/A"] <- NA

library(tidyr)
#food_world_cup_gather <- na.omit(gather(food_world_cup, country, value, algeria:vietnam))
food_world_cup_gather <- gather(food_world_cup, country, value, algeria:vietnam)
                                 
food_world_cup_gather$value <- as.numeric(food_world_cup_gather$value)
food_world_cup_gather$country <- as.factor(food_world_cup_gather$country)
```

```{r fig.width=20}
library(ggplot2)

order <- aggregate(food_world_cup_gather$value, by = list(country = food_world_cup_gather$country), FUN = sum)

food_world_cup_gather$country <- factor(food_world_cup_gather$country, levels = order$country[order(order$x, decreasing = TRUE)])

ggplot(food_world_cup_gather, aes(x = country, y = value, fill = gender)) +
  geom_bar(stat = "identity") +
  facet_grid(age ~ education)
```

```{r fig.width=20}
ggplot(food_world_cup_gather, aes(x = country, y = value, fill = gender)) +
  geom_bar(stat = "identity") +
  facet_grid(education ~ household_income)
```

```{r fig.width=20}
ggplot(food_world_cup_gather, aes(x = country, y = value, fill = gender)) +
  geom_bar(stat = "identity") +
  facet_grid(knowledge ~ interest)
```

```{r fig.width=20}
ggplot(food_world_cup_gather, aes(x = country, y = value, fill = gender)) +
  geom_boxplot()
```

---

```{r}

```


---

http://www.r-tutor.com/deep-learning/introduction

https://www.r-bloggers.com/r-for-deep-learning-i-build-fully-connected-neural-network-from-scratch/

https://cran.r-project.org/web/packages/nnet/nnet.pdf

https://cran.r-project.org/web/packages/h2o/h2o.pdf

---

https://cran.r-project.org/web/packages/neuralnet/neuralnet.pdf

```{r}
library(neuralnet)
AND <- c(rep(0,7),1)
OR <- c(0,rep(1,7))
binary.data <- data.frame(expand.grid(c(0,1), c(0,1), c(0,1)), AND, OR)
print(net <- neuralnet(AND+OR~Var1+Var2+Var3, binary.data, hidden=0,rep=10, err.fct="ce", linear.output=FALSE))
plot(net)

data(infert, package="datasets")
print(net.infert <- neuralnet(case~parity+induced+spontaneous, infert,err.fct="ce", linear.output=FALSE, likelihood=TRUE))
plot(net.infert)

gwplot(net.infert, selected.covariate="parity")
confidence.interval(net.infert)
prediction(net.infert)


Var1 <- runif(50, 0, 100) 
sqrt.data <- data.frame(Var1, Sqrt=sqrt(Var1))
print(net.sqrt <- neuralnet(Sqrt~Var1,  sqrt.data, hidden=10, 
                  threshold=0.01))
compute(net.sqrt, (1:10)^2)$net.result
plot(net.sqrt)
```

https://cran.r-project.org/web/packages/darch/darch.pdf

```{r}
library(darch)



```

https://cran.r-project.org/web/packages/deepnet/deepnet.pdf

------------------

<br>

```{r echo=FALSE, message=FALSE, warning=FALSE, fig.width=6, fig.height=4, fig.align="center", cache=FALSE}
sessionInfo()
```
